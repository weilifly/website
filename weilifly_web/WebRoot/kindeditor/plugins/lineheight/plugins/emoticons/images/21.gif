³!") ;
					return INPUT ;
				}
			}
			
			Map<String,String> carMap = cartService.addComProductCartImm(main_productid,product_num , colorid , userid,cart_price, colorList);
			if(carMap==null||StringUtils.isBlank(carMap.get("carIds"))){
				msgflag = 11;
				//request("msg","è´­ä¹°ç»„åˆå•†å“å¤±è´¥!") ;
				return INPUT;
			}
			//æ·»åŠ æˆåŠŸè·³è½¬åˆ°è®¢å•å¡«å†™é¡µé¢
			if(carMap!=null&&StringUtils.isNotBlank(carMap.get("carIds"))){
				//æŸ¥è¯¢è¯¥ç»„åˆçš„æ‰€æœ‰ç»„åˆå•†å“åŒ…å«ä¸»å•†å“
				String carIds = carMap.get("carIds") ;
				request("carIds",carIds);
				//é…é€ç‰©æµ
				List<Map<String,Object>> logistList = logisticsService.queryLogisticsAll();
				request("logistList",logistList);
				//åŠ è½½çœä»½
				List<Map<String,Object>> provincelist = regionService.queryRegionList(-1L, 1L, 1);
				request("provinceList",provincelist);
				//åŠ è½½åœ°å€
				addressList = addressService.queryUserAddress(userid);
				Integer[]  statuss = {IConstants.CART_TYPE_COMM_MAIN,IConstants.CART_TYPE_COMM_FU,IConstants.CART_TYPE_COMM_IMM,IConstants.CART_TYPE_PANIC_IMM} ;//1 æ™®é€šä¸»å•†å“ 2æ™®é€šå‰¯å•†å“  3æ™®é€šç«‹å³è´­ä¹°4 é¢„çº¦å•†å“ 5æŠ¢è´­å•†å“
				Map<String,String> totalMap = cartService.queryProductCartTotalPrice(userid,carIds,statuss);
					if(totalMap!=null){
						totalPrice = totalMap.get("total_price");
						totalItems = totalMap.get("total_items");
						totalNum = totalMap.get("total_num");
						if(carIds==null||carIds==""){
							totalPrice= "0.00" ;
						}
						//æ£€æŸ¥ç”¨æˆ·ç§¯åˆ†æ˜¯å¦å¤Ÿç”¨
						BigDecimal int_total =Convert.strToBigDecimal(totalMap.get("int_total"), new BigDecimal(0)) ;
						if(int_total!=null&&int_total.compareTo(BigDecimal.ZERO)>=0){
							boolean int_bool = this.checkUserInt(userid,int_total);
							if(!int_bool){
								msgflag= 14;
					